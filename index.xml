<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Leo Sheu 的日常筆記</title><link>https://blog.sheu.pw/</link><description>Recent content on Leo Sheu 的日常筆記</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><lastBuildDate>Sun, 13 Nov 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.sheu.pw/index.xml" rel="self" type="application/rss+xml"/><item><title>unit test - 在特定參數條件時回傳造假資料</title><link>https://blog.sheu.pw/p/unit-test-%E5%9C%A8%E7%89%B9%E5%AE%9A%E5%8F%83%E6%95%B8%E6%A2%9D%E4%BB%B6%E6%99%82%E5%9B%9E%E5%82%B3%E9%80%A0%E5%81%87%E8%B3%87%E6%96%99/</link><pubDate>Sun, 13 Nov 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/unit-test-%E5%9C%A8%E7%89%B9%E5%AE%9A%E5%8F%83%E6%95%B8%E6%A2%9D%E4%BB%B6%E6%99%82%E5%9B%9E%E5%82%B3%E9%80%A0%E5%81%87%E8%B3%87%E6%96%99/</guid><description>&lt;h3 id="情境">情境&lt;/h3>
&lt;p>在寫單元測試時，想判斷輸入物件的其中一個 property 是特定數值才回傳造假資料。
可以限縮造假的範圍來提高正確性。&lt;/p>
&lt;h3 id="使用-nsubstitute-argist-有條件的比對參數">使用 NSubstitute Arg.Is&amp;lt;T&amp;gt; 有條件的比對參數&lt;/h3>
&lt;p>有個 mail 物件，在寫測試時想造假特定收件人寄送的回傳值。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">Mail&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="n">Recipient&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="k">get&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">set&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="n">Subject&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="k">get&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">set&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">AttachFile&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="n">Attachment&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="k">get&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">set&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>這時可以使用 &lt;code>Arg.Is&amp;lt;T&amp;gt;(condition)&lt;/code> 裡面帶入指定條件，以此範例為收件人是 Leo 時才回傳造假的結果 &lt;code>true&lt;/code>。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_mailService&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Arg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Is&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Mail&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Recipient&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;Leo&amp;#34;&lt;/span>&lt;span class="p">)).&lt;/span>&lt;span class="n">Returns&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">true&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另外想測試是否有特定參數的呼叫 &lt;code>Received&lt;/code> 一次，也可以使用 &lt;code>Arg.Is&lt;/code> 去限縮條件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_mailService&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Received&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">Send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Arg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Is&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">Mail&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Recipient&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="s">&amp;#34;Leo&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="reference">Reference&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://nsubstitute.github.io/help/argument-matchers/" target="_blank" rel="noopener"
>Argument matchers - Conditionally matching an argument&lt;/a>&lt;/p>
&lt;/blockquote></description></item><item><title>如何在 Windows 10 修改 MAC Address</title><link>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/</link><pubDate>Mon, 19 Sep 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/</guid><description>&lt;ol>
&lt;li>Windows 設定 &amp;gt; 網路和網際網路 &amp;gt; 狀態，點選 &amp;ldquo;變更介面卡選項&amp;rdquo;&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-1.png"
width="773"
height="470"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-1_hu5a0771fbee9541d8ca4c49192db94cfa_21661_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-1_hu5a0771fbee9541d8ca4c49192db94cfa_21661_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="164"
data-flex-basis="394px"
>&lt;/p>
&lt;ol start="2">
&lt;li>找到要修改的網路，右鍵 &amp;gt; 內容&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-2.png"
width="857"
height="381"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-2_hu65ee4f8fe47a50dd10fa3a755eb4b95a_38663_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-2_hu65ee4f8fe47a50dd10fa3a755eb4b95a_38663_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="224"
data-flex-basis="539px"
>&lt;/p>
&lt;ol start="3">
&lt;li>點選設定&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-3.png"
width="421"
height="533"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-3_hu7bcb86a038472a16fb4b47cc4da26e3e_28044_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-3_hu7bcb86a038472a16fb4b47cc4da26e3e_28044_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="78"
data-flex-basis="189px"
>&lt;/p>
&lt;ol start="4">
&lt;li>進階 &amp;gt; 本地管理位置 &amp;gt; 值，修改成指定的 MAC address 即可
&lt;ul>
&lt;li>例如 &lt;code>F8:8C:21:77:FB:CB&lt;/code> 則填入 &lt;code>F88C2177FBCB&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-4.png"
width="465"
height="518"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-4_huc12d27f01a0b8e06155073cc682398aa_28610_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%9C%A8-windows-10-%E4%BF%AE%E6%94%B9-mac-address/mac-4_huc12d27f01a0b8e06155073cc682398aa_28610_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="89"
data-flex-basis="215px"
>&lt;/p>
&lt;p>最後再利用指令檢查是否修改完成 (實體位址)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">ipconfig&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">all&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>如何對 protected method 做 unit test</title><link>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%B0%8D-protected-method-%E5%81%9A-unit-test/</link><pubDate>Sun, 18 Sep 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%B0%8D-protected-method-%E5%81%9A-unit-test/</guid><description>&lt;h3 id="情境">情境&lt;/h3>
&lt;p>在寫單元測試時，如果想要針對一個 protected method 做測試時，在測試專案想要存取 method 時會顯示 &lt;code>cannot access protected method 'XXX' here&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%B0%8D-protected-method-%E5%81%9A-unit-test/protected-1.png"
width="493"
height="81"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%B0%8D-protected-method-%E5%81%9A-unit-test/protected-1_hu2af8c1e2253013247eaf1a83c2b23754_4593_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E5%B0%8D-protected-method-%E5%81%9A-unit-test/protected-1_hu2af8c1e2253013247eaf1a83c2b23754_4593_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="608"
data-flex-basis="1460px"
>&lt;/p>
&lt;p>一般情況下最好是由呼叫 &lt;code>Protected&lt;/code> 的 &lt;code>Public&lt;/code> method 去做測試，但如果萬不得已，也有可以對 protected method 進行測試的方法。&lt;/p>
&lt;h3 id="testing-protected-methods">Testing Protected Methods&lt;/h3>
&lt;p>假設有個 protected method &lt;code>MyMethodName&lt;/code>，我們想要對這個 method 進行單元測試。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">OriginalClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">protected&lt;/span> &lt;span class="k">override&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="n">MyMethodName&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;any string&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>這時可以在測試專案新增一個 &lt;code>FakeClass&lt;/code> 去繼承 &lt;code>OriginalClass&lt;/code>，並新增一個 method，透過 new 修飾詞隱藏繼承自基底類別的方法，FakeClass 中 method 的實作使用 base 呼叫基底類別原有的方法。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">FakeClass&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">OriginalClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="n">MyMethodName&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="k">base&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">MyMethodName&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最後測試時使用 &lt;code>FakeClass&lt;/code> 呼叫 &lt;code>MyMethodName&lt;/code> 進行測試即可。&lt;/p>
&lt;hr>
&lt;h3 id="reference">Reference&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://learn.microsoft.com/zh-tw/dotnet/csharp/programming-guide/classes-and-structs/knowing-when-to-use-override-and-new-keywords" target="_blank" rel="noopener"
>了解使用 Override 和 New 關鍵字的時機&lt;/a>&lt;br>
&lt;a class="link" href="https://learn.microsoft.com/zh-tw/dotnet/csharp/language-reference/keywords/new-modifier" target="_blank" rel="noopener"
>new 修飾詞 (C# 參考)&lt;/a>&lt;/p>
&lt;/blockquote></description></item><item><title>漏洞回報 健檢中心醫療資料存取控制缺陷</title><link>https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/</link><pubDate>Sun, 28 Aug 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/</guid><description>&lt;p>&lt;img src="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-1.png"
width="386"
height="548"
srcset="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-1_huf61adda9e76650550627015e372c4a57_51138_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-1_huf61adda9e76650550627015e372c4a57_51138_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="70"
data-flex-basis="169px"
>&lt;/p>
&lt;h3 id="敘述">敘述&lt;/h3>
&lt;p>做完健康檢查後，在網站上登入後查看報告時，發現有個報告書下載的功能。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-2.png"
width="939"
height="585"
srcset="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-2_hu8ee8df1d4ae536955f7298e0b5da1d93_486501_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-2_hu8ee8df1d4ae536955f7298e0b5da1d93_486501_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="160"
data-flex-basis="385px"
>&lt;/p>
&lt;p>下載完成後是一個PDF檔，這時發現下載網址後有個 &lt;code>bid&lt;/code> 的參數。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-3.png"
width="769"
height="198"
srcset="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-3_hubafaff9ae1e3b441aff4e57cb229edf5_13956_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-3_hubafaff9ae1e3b441aff4e57cb229edf5_13956_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="388"
data-flex-basis="932px"
>&lt;/p>
&lt;p>看起來 &lt;code>bid&lt;/code> 的參數是有規律且有序的，此時嘗試修改不同的數值嘗試發起 request，發現可以正常取得 PDF 報告書。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-4.png"
width="1082"
height="523"
srcset="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-4_huf9e0bf79626cd035dafe1eb856dcebb6_133228_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-4_huf9e0bf79626cd035dafe1eb856dcebb6_133228_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="206"
data-flex-basis="496px"
>&lt;/p>
&lt;p>此存取控制缺陷的漏洞會造成可以取得他人的健檢報告資料。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-5.png"
width="751"
height="608"
srcset="https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-5_hud366d1cf7aa80b439cb6df33731bde6a_51074_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E6%BC%8F%E6%B4%9E%E5%9B%9E%E5%A0%B1-%E5%81%A5%E6%AA%A2%E4%B8%AD%E5%BF%83%E9%86%AB%E7%99%82%E8%B3%87%E6%96%99%E5%AD%98%E5%8F%96%E6%8E%A7%E5%88%B6%E7%BC%BA%E9%99%B7/mornjoy-5_hud366d1cf7aa80b439cb6df33731bde6a_51074_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="123"
data-flex-basis="296px"
>&lt;/p>
&lt;h3 id="相關網址">相關網址&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://medirep.mornjoy.com.tw/Login/Index
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://medirep.mornjoy.com.tw/siteadmin/Print?bid=_{Id}_
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="時間軸">時間軸&lt;/h3>
&lt;blockquote>
&lt;p>2022/05/30 - 提交漏洞&lt;br>
2022/06/02 - 通報未回應 (由 HITCON ZeroDay 服務團隊)&lt;br>
2022/06/07 - 複測已修復 (by Leo)&lt;br>
2022/07/30 - 公開&lt;/p>
&lt;/blockquote>
&lt;p>回報於 &lt;a class="link" href="https://zeroday.hitcon.org/vulnerability/ZD-2022-00376" target="_blank" rel="noopener"
>HITCON ZeroDay：晨悅預防醫學機構 醫療資料存取漏洞&lt;/a>&lt;/p>
&lt;hr>
&lt;h3 id="reference">Reference&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://portswigger.net/web-security/access-control" target="_blank" rel="noopener"
>Access control vulnerabilities and privilege escalation | Web Security Academy&lt;/a>&lt;/p>
&lt;/blockquote></description></item><item><title>所有的 Class 都要加 Interface 嗎?</title><link>https://blog.sheu.pw/p/why-add-interface/</link><pubDate>Sun, 07 Aug 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/why-add-interface/</guid><description>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">interface&lt;/span> &lt;span class="nc">ITextSummarizer&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="n">summarizeText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">text&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">TextSummarizer&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">ITextSummarizer&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">string&lt;/span> &lt;span class="n">summarizeText&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">text&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//do something&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;summarize text&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>雖然 TextSummarizer 只有一個實作，就算之後不會有另一個實作，加上 interface 也有其他好處。&lt;/p>
&lt;h3 id="定義-interface-的優點">定義 interface 的優點：&lt;/h3>
&lt;ul>
&lt;li>可以使測試更容易 - 如果要在測試期間使用 mock 或 fake 假的實作，會需要定義一個介面來執行此操作。&lt;/li>
&lt;li>讓公用 API 更清晰 - 使用端應該或不應該使用哪些功能不會產生混淆。&lt;/li>
&lt;li>有可能猜錯只需要一個實作 - 最初寫程式時可能確定真的不需要第二個實作，但經過一兩個月後，這個假設可能被證明是錯誤的。&lt;/li>
&lt;li>同一類別可以解決兩個子問題 - 有時某個類別可以為兩個或多個不同的抽象層提供實作。例如 LinkedList 實作類別可以實作 List 和 Queue 介面。&lt;/li>
&lt;/ul>
&lt;h3 id="定義-interface-的缺點">定義 interface 的缺點：&lt;/h3>
&lt;ul>
&lt;li>需要付出更多努力 - 如果沒有 IDE 的幫忙，可能要手動多寫幾行程式碼。
-&amp;gt; &lt;a class="link" href="https://www.jetbrains.com/help/rider/Refactorings__Extract_Interface.html" target="_blank" rel="noopener"
>使用 Rider 自動產生 Interface&lt;/a>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="reference">Reference&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://www.tenlong.com.tw/products/9786263242128" target="_blank" rel="noopener"
>Good Code, Bad Code｜寫出高品質的程式碼&lt;/a> PART 1 理論篇 - 第2章 抽象層&lt;/p>
&lt;/blockquote></description></item><item><title>Hugo start</title><link>https://blog.sheu.pw/p/hugo-start/</link><pubDate>Sun, 31 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/hugo-start/</guid><description>&lt;img src="https://blog.sheu.pw/p/hugo-start/hugo-logo.svg" alt="Featured image of post Hugo start" />&lt;p>[Windows]
透過 &lt;a class="link" href="https://scoop.sh/" target="_blank" rel="noopener"
>Scoop&lt;/a> 安裝：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">scoop&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">hugo&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Hugo start： &lt;a class="link" href="https://gohugo.io/getting-started/quick-start" target="_blank" rel="noopener"
>https://gohugo.io/getting-started/quick-start/&lt;/a>&lt;/p>
&lt;p>Theme： &lt;a class="link" href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener"
>https://github.com/CaiJimmy/hugo-theme-stack&lt;/a>&lt;/p>
&lt;p>Run server (include content marked as draft)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">hugo&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">-D&lt;/span> &lt;span class="n">-p&lt;/span> &lt;span class="n">8888&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>使用 Autofac KeyFilter Attribute 在相同介面注入不同實體</title><link>https://blog.sheu.pw/p/autofac-keyfilter-attribute/</link><pubDate>Fri, 22 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/autofac-keyfilter-attribute/</guid><description>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">interface&lt;/span> &lt;span class="nc">IAlertService&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">void&lt;/span> &lt;span class="n">SendAlert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">SlackAlertService&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">IAlertService&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">SendAlert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">){}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">TelegramAlertService&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">IAlertService&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">SendAlert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">){}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>假如有個 TestAlertService 需要同時使用到 SlackAlertService 和 TelegramAlertService ，在使用 autofac 注入時因為兩個 service 都使用相同的介面，這個時候可以透過加上 KeyFilter attribute 的方式來指定所需要的實體。&lt;/p>
&lt;p>KeyFilter 的使用方式：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="k">public&lt;/span> &lt;span class="k">class&lt;/span> &lt;span class="nc">TestAlertService&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">IAlertService&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">public&lt;/span> &lt;span class="n">TestAlertService&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">KeyFilter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;slack&amp;#34;&lt;/span>&lt;span class="p">)]&lt;/span> &lt;span class="n">IAlertService&lt;/span> &lt;span class="n">slackAlert&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">KeyFilter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;telegram&amp;#34;&lt;/span>&lt;span class="p">)]&lt;/span> &lt;span class="n">IAlertService&lt;/span> &lt;span class="n">slackAlert&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在註冊時需要透過設定好的 key 去指定相對應的實作，以及設定哪個類別要使用 attribute filter：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-C#" data-lang="C#">&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RegisterType&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">SlackAlertService&lt;/span>&lt;span class="p">&amp;gt;().&lt;/span>&lt;span class="n">Keyed&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">IAlertService&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="s">&amp;#34;slack&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RegisterType&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">TelegramAlertService&lt;/span>&lt;span class="p">&amp;gt;().&lt;/span>&lt;span class="n">Keyed&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">IAlertService&lt;/span>&lt;span class="p">&amp;gt;(&lt;/span>&lt;span class="s">&amp;#34;telegram&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">builder&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">RegisterType&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">TestAlertService&lt;/span>&lt;span class="p">&amp;gt;().&lt;/span>&lt;span class="n">As&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">IAlertService&lt;/span>&lt;span class="p">&amp;gt;().&lt;/span>&lt;span class="n">WithAttributeFiltering&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;hr>
&lt;p>參考資料：&lt;a class="link" href="https://autofac.readthedocs.io/en/latest/advanced/keyed-services.html?highlight=named#resolving-with-attributes" target="_blank" rel="noopener"
>[Autofac] resolving with attributes&lt;/a>&lt;/p></description></item><item><title>如何查詢 w3wp.exe 對應的 IIS Application Pool</title><link>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/</link><pubDate>Thu, 02 Sep 2021 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/</guid><description>&lt;p>on Windows 2012 (IIS 8)&lt;/p>
&lt;ol>
&lt;li>
&lt;p>選擇想要檢視的 IIS Worker Process&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-1.png"
width="650"
height="412"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-1_hub29babf6175394838e5c78e03b7ce5a7_46549_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-1_hub29babf6175394838e5c78e03b7ce5a7_46549_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="157"
data-flex-basis="378px"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>切到 detail 查看該 process 的 PID&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-2.png"
width="650"
height="357"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-2_huc407bfe8864868fca295eada6294ab55_51189_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-2_huc407bfe8864868fca295eada6294ab55_51189_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="182"
data-flex-basis="436px"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>切換到 C:\Windows\System32\inetsrv ，執行 &lt;code>.\appcmd.exe list wp&lt;/code> 找到對應的 PID&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-3.png"
width="677"
height="343"
srcset="https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-3_huf1ef8aeac24f219555e550f01d095eca_19525_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%A6%82%E4%BD%95%E6%9F%A5%E8%A9%A2-w3wp.exe-%E5%B0%8D%E6%87%89%E7%9A%84-iis-application-pool/w3wp-3_huf1ef8aeac24f219555e550f01d095eca_19525_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="197"
data-flex-basis="473px"
>&lt;/p>
&lt;/li>
&lt;/ol></description></item><item><title>台灣網路資訊中心 域名管理關鍵 Key 共用漏洞</title><link>https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/</link><pubDate>Wed, 10 Mar 2021 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/</guid><description>&lt;p>某天逛 Facebook 突然發現有個「中文化電子郵件信箱體驗活動」，只要動動手指就可以體驗看起來很狂的中文信箱地址，而且還附贈該中文網域名稱一年，就趕緊就來申請囉。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-1.png"
width="1280"
height="642"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-1_hu80b091ff53f3db5b4656c6844e437b96_491401_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-1_hu80b091ff53f3db5b4656c6844e437b96_491401_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>在經過很多步驟和教學後，終於拿到了成功獲得域名通知信，信中給了個連結可以設定管理網域的判別密碼。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-2.png"
width="828"
height="401"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-2_hu7cbc7f6099b2b33429abb9cb195bae74_65622_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-2_hu7cbc7f6099b2b33429abb9cb195bae74_65622_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="206"
data-flex-basis="495px"
>&lt;/p>
&lt;p>可以看到設定判別密碼的網址帶了兩個參數 key 及 dn，key 是一串亂碼，而 dn 則是個人中文網域名稱 (灰色方塊部分)。&lt;/p>
&lt;p>-&amp;gt;透過此網址可重複修改密碼&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-3.png"
width="917"
height="567"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-3_hu69c8fe13b8b744f8c9104fdd42f6b48a_310902_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-3_hu69c8fe13b8b744f8c9104fdd42f6b48a_310902_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="161"
data-flex-basis="388px"
>&lt;/p>
&lt;p>接著就收到一封邀請好友的信件，點擊信中連結輸入好友 Gmail 信箱，成功推廣可以有抽獎點數。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-4.png"
width="1280"
height="491"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-4_hu98ad4a81ecba4400a0e3f015b88958d9_172890_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-4_hu98ad4a81ecba4400a0e3f015b88958d9_172890_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="260"
data-flex-basis="625px"
>&lt;/p>
&lt;p>但點進去推廣頁面，看了網址所帶的參數覺得怎麼有種似曾相識的感覺？&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-5.png"
width="982"
height="630"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-5_hu79ea708aeb1bb198cd7001ba21d08d4f_144329_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-5_hu79ea708aeb1bb198cd7001ba21d08d4f_144329_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="155"
data-flex-basis="374px"
>&lt;/p>
&lt;p>推廣頁面和設定密碼的頁面所使用的 key 竟然是同一把！&lt;/p>
&lt;p>如果任何人知道你的中文網域名稱及邀請頁面連結，代入 &lt;code>KEY&lt;/code> 及 &lt;code>網域名稱&lt;/code> 到設定密碼頁面，即可修改他人的判別密碼。&lt;/p>
&lt;p>&lt;a class="link" href="https://rs.twnic.net.tw/cgi-bin/eai/chgpass.cgi?key=" target="_blank" rel="noopener"
>https://rs.twnic.net.tw/cgi-bin/eai/chgpass.cgi?key=&lt;/a> {KEY} &amp;amp;dn= {網域名稱}.台灣&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-6.png"
width="1280"
height="656"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-6_hu6488018c6ef51a37eb9ff2c4f1bb0d2f_588262_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-6_hu6488018c6ef51a37eb9ff2c4f1bb0d2f_588262_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="195"
data-flex-basis="468px"
>&lt;/p>
&lt;p>用修改後的密碼登入就可以取得原域名擁有者的所有權限，可以更改 DNS 設定、查看或修改個人資料等等。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-7.png"
width="748"
height="261"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-7_hue4109e8ad34467f42b9f77bf2cf8ef68_28474_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-7_hue4109e8ad34467f42b9f77bf2cf8ef68_28474_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="286"
data-flex-basis="687px"
>&lt;/p>
&lt;p>如果你公布了你的網域名稱，順便附上信中的推廣連結，等於是告訴人：來吧，可以幫我改密碼喔。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-8.png"
width="900"
height="346"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-8_hu5ef58bf126b5281f8d69048269b4aaa3_65731_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-8_hu5ef58bf126b5281f8d69048269b4aaa3_65731_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="260"
data-flex-basis="624px"
>&lt;/p>
&lt;p>為了避免關鍵 key 外流，我推廣好友自己打 Gmail 信箱總安全了吧，這樣想就大錯特錯了！&lt;/p>
&lt;p>就算自己打信箱推廣，被推廣好友所收到確認信所含連結也有那把可以重設密碼的 key (右下黃色區塊)。總之，如果要推廣好友，絕對不能把我的網域名稱告訴他人，不然他就能幫忙改密碼並接管自己的個人網域了。&lt;/p>
&lt;p>-&amp;gt;同一人所發出邀請 key 皆相同，參數 rec 不同被推廣者皆不相同。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-9.png"
width="946"
height="423"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-9_huef892dcf527c88c9e3d21bd6182bd03b_67227_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-9_huef892dcf527c88c9e3d21bd6182bd03b_67227_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="223"
data-flex-basis="536px"
>&lt;/p>
&lt;p>之後把情況詳情回報給台灣網路資訊中心，當天幾小時後重設密碼的頁面就自動跳轉到 &lt;a class="link" href="https://rs.twnic.net.tw/cgi-bin/eai/chgpass.cgi" target="_blank" rel="noopener"
>https://rs.twnic.net.tw/cgi-bin/eai/chgpass.cgi&lt;/a> 乾淨的網址，改成用 Form Data 的形式送出 key &amp;amp; dn，暫時先改變資料送出的形式，把漏洞變得比較不明顯。&lt;/p>
&lt;p>幸好隔天重設密碼的流程就換了，改成只回傳一個&amp;lt;script&amp;gt; alert，提示至信箱確認變更密碼連結，他人就不再能簡單取得個人網域權限了，當天的修改貌似只是不想讓更多人能一眼就發現並使用這個漏洞。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-10.png"
width="830"
height="216"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-10_hu8b06fe22144b089a9988e26d0d0656d3_17172_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-10_hu8b06fe22144b089a9988e26d0d0656d3_17172_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="384"
data-flex-basis="922px"
>&lt;/p>
&lt;p>設定密碼的頁面所使用的 key (灰色部分) 終於不是那組連推廣都共用的那把了。&lt;/p>
&lt;p>&lt;img src="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-11.png"
width="991"
height="606"
srcset="https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-11_huc025ae6092f993191dbf600f0d19167c_306089_480x0_resize_box_3.png 480w, https://blog.sheu.pw/p/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83-%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E/twnic-11_huc025ae6092f993191dbf600f0d19167c_306089_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="163"
data-flex-basis="392px"
>&lt;/p>
&lt;p>查了一下此活動開始也有一段時間了，不過看起來還沒有人發現。為了避免更多資料外洩，當天即送出了問題回報，他們也非常快速的解決了問題，在隔天即修復完成。除了讓人佩服工程師的努力外，正面面對漏洞修補的態度也值得讚賞。&lt;/p>
&lt;p>這個問題的根本原因就是重設密碼所用的 token 也被其他服務所使用，而該推廣中文域名活動的服務剛好會讓 token 流出給第三者，而讓外人可以輕易取得域名管理權限。&lt;/p>
&lt;p>其實只要多留意並不難發現這個漏洞，但它還是存在了幾個禮拜的時間，這也說明了網路上並不是沒有漏洞，而是缺少發現。身為使用者可以多仔細觀察，協助政府或企業發現問題。而開發者則要注意並不是使用亂數當 token 就安全，也要注意在設定密碼這種比較敏感的服務和其他一般服務所使用的 token 必須要有所區隔。&lt;/p>
&lt;p>時間軸：&lt;/p>
&lt;pre>&lt;code>2017/3/30：漏洞詳情回報給財團法人台灣網路資訊中心
2017/3/31：修復了此漏洞
&lt;/code>&lt;/pre>
&lt;p>本文同步刊載於 &lt;a class="link" href="https://kb.hitcon.org/post/159329007522/%E5%8F%B0%E7%81%A3%E7%B6%B2%E8%B7%AF%E8%B3%87%E8%A8%8A%E4%B8%AD%E5%BF%83%E5%9F%9F%E5%90%8D%E7%AE%A1%E7%90%86%E9%97%9C%E9%8D%B5-key-%E5%85%B1%E7%94%A8%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener"
>HITCON Knowledge Base&lt;/a> in 2017.04&lt;/p></description></item><item><title>Archives</title><link>https://blog.sheu.pw/archives/</link><pubDate>Tue, 21 Jan 2020 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/archives/</guid><description/></item><item><title>About</title><link>https://blog.sheu.pw/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/about/</guid><description>&lt;p>hi&lt;/p></description></item><item><title>Search</title><link>https://blog.sheu.pw/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.sheu.pw/search/</guid><description/></item></channel></rss>